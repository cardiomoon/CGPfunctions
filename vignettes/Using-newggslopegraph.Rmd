---
title: "Using newggslopegraph"
author: "Chuck Powell"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Using newggslopegraph}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
This function is designed to automate the process of producing a [Tufte style slopegraph](https://www.edwardtufte.com/bboard/q-and-a-fetch-msg?msg_id=0003nk) using `ggplot2`. 

I've been aware of slopegraphs and bumpcharts for quite some time, and I certainly am aware of [Tufte's work](https://www.edwardtufte.com/tufte/). As an amateur military historian I've always loved, for example, [his poster](https://www.edwardtufte.com/tufte/posters) depicting Napoleon's Russian Campaign. So when I saw the article from [Murtaza Haider](https://www.r-bloggers.com/author/murtaza-haider/) titled *"Edward Tufteâ€™s Slopegraphs and political fortunes in Ontario"* I just had to take a shot at writing a function.

To make it a little easier to get started with the function I have taken the libefty of providing the cancer data in a format where it is immediately useable.  Please see `?newcancer`.

## Installation and setup

Long term I'll try and ensure the version on `CRAN` is well maintained but for now you're better served by grabbing the current version from GITHUB.

```{r setup}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
# Install from CRAN
# install.packages("CGPfunctions")

# Or the development version from GitHub
# install.packages("devtools")
devtools::install_github("ibecav/CGPfunctions")
library(CGPfunctions)
```

## Simple example

If you're unfamiliar with slopegraphs or just want to see what the display is all about the dataset I've provided can get you started in one line

```{r ggslope1, fig.height=10, fig.width=7}
newggslopegraph(newcancer,Year,Survival,Type)
```

Optionally you can provide important label information through `Title`, `Subtitle`, and `Caption` arguments.  You can suppress them all together by setting them `= NULL` but since I think they are very important the default is to gently remind you, that you have not tpovidecd any information.  Let's provide a title and sub-title but skip the caption.

```{r ggslope2, , fig.height=10, fig.width=7}
newggslopegraph(dataframe = newcancer,
                Times = Year,
                Measurement = Survival,
                Grouping = Type,
                Title = "Estimates of Percent Survival Rates",
                SubTitle = "Based on: Edward Tufte, Beautiful Evidence, 174, 176.",
                Caption = NULL
                )
```



Take the user's input and parse it into one of four known possibilities and then take appropriate action.  The possibilities are:

1.  If both are `bare` variables and found in the dataframe immediately print the plot
2.  At least one of the variables is `bare` and found in the dataframe (variable x) and the other is one or more column numbers (variable y)
3.  At least one of the variables is `bare` and found in the dataframe (variable y) and the other is one or more column numbers (variable x)
4.  Both the variables were passed to us as numbers.  Could be one or more numbers for either variable.

## Example scenario ... What makes us happy?

The documentation examples use the `mtcars` built-in dataset.  It's handy, convenient, and it's installed by default. To actually show the function in action, however, I'm going to use a different dataset.  Something that should allow you to better see the value of making plots of the crosstabs rather than simple tables.  It also has the happy property of being much much larger than `mtcars` so we can see if there are lags in performance due to the number of rows.

Rather than provide my own or make anyone work too hard I selected that `happy` dataset that comes bundled with several `R` packages including `productplots` and `GGally`.   From the description:

> The data is a small sample of variables related to happiness from the general social survey (GSS). The GSS is a yearly cross-sectional survey of Americans, run from 1976. We combine data for 25 years to yield 51,020 observations, and of the over 5,000 variables, we select nine related to happiness. 


We'll be focusing on the non numeric variables.  I certainly can't claim to do a detailed analysis here but at least the questions will be fun I hope...

```{r ggslope2}
newggslopegraph(newcancer,Year,Survival,Type)
```

I hope you've found this useful.  I am always open to comments, corrections and suggestions.

Chuck (ibecav at gmail dot com)

### License
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
