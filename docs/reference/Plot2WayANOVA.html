<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot a 2 Way ANOVA using dplyr and ggplot2 — Plot2WayANOVA • CGPfunctions</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Plot a 2 Way ANOVA using dplyr and ggplot2 — Plot2WayANOVA" />

<meta property="og:description" content="Takes a formula and a dataframe as input, conducts an analysis of variance
using the base R aov command and produces the results (AOV summary table and
table of means) to the console and as a plotted interaction graph (line or
bar) using ggplot2.  Also uses Brown-Forsythe test for homogeneity of
variance." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CGPfunctions</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CGPfunctions.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ibecav/CGPfunctions">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a 2 Way ANOVA using dplyr and ggplot2</h1>
    <small>Source: <a href='https://github.com/ibecav/CGPfunctions/blob/master/R/Plot2WayANOVA.R'><code>R/Plot2WayANOVA.R</code></a></small>
    <p class="hidden name"><code>Plot2WayANOVA.Rd</code></p>
    </div>

    
    <p>Takes a formula and a dataframe as input, conducts an analysis of variance
using the base R aov command and produces the results (AOV summary table and
table of means) to the console and as a plotted interaction graph (line or
bar) using ggplot2.  Also uses Brown-Forsythe test for homogeneity of
variance.</p>
    

    <pre class="usage"><span class='fu'>Plot2WayANOVA</span>(<span class='no'>formula</span>, <span class='kw'>dataframe</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>confidence</span><span class='kw'>=</span><span class='fl'>.95</span>,
    <span class='kw'>plottype</span> <span class='kw'>=</span> <span class='st'>"bar"</span>, <span class='kw'>PlotSave</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a valid R formula with a numeric dependent (outcome)
variable, and two independent (predictor) variables e.g. <code>mpg~am*vs</code>.
The independent variables are forced to factors (with warning) if possible.</p></td>
    </tr>
    <tr>
      <th>dataframe</th>
      <td><p>a dataframe or an object that can be coerced to a dataframe</p></td>
    </tr>
    <tr>
      <th>confidence</th>
      <td><p>what confidence level for confidence intervals</p></td>
    </tr>
    <tr>
      <th>plottype</th>
      <td><p>bar or line (quoted)</p></td>
    </tr>
    <tr>
      <th>PlotSave</th>
      <td><p>a logical indicating whether the user wants to save the plot as a png file</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with 4 elements which is returned invisibly. The items are always sent 
to the console for display  The plot is always sent to the default plot device
but for user convenience the function also returns a named list with the following items
in case the user desires to save them or further process them. <code>$ANOVATable</code>, 
<code>$MeansTable</code>, <code>$BFTest</code>, and <code>$SWTest</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Details about how the function works in order of steps taken.</p><ol>
<li><p>Some basic error checking to ensure a valid formula and dataframe.
Only accepts fully crossed formula to check for interaction term</p></li>
<li><p>Ensure the dependent (outcome) variable is numeric and that the two
independent (predictor) variables are or can be coerced to factors -- user
warned on the console</p></li>
<li><p>Remove missing cases -- user warned on the console</p></li>
<li><p>Use <code>dplyr</code> to calculate a summarized table of means,
sds, standard errors of the means, confidence intervals, and group sizes.</p></li>
<li><p>Use the <code>aov</code> function to execute an Analysis of Variance (ANOVA)</p></li>
<li><p>Use the <code><a href='neweta.html'>neweta</a></code> function to calculate eta squared values.
If the design is unbalanced warn the user and use Type II sums of squares</p></li>
<li><p>Produce a standard ANOVA table with a column for eta-squared appended</p></li>
<li><p>Use the <code>leveneTest</code> for testing Homogeneity of Variance
assumption with Brown-Forsythe</p></li>
<li><p>Use the <code>shapiro.test</code> for testing normality assumption with Shapiro-Wilk</p></li>
<li><p>Use <code>ggplot2</code> to plot an interaction plot of the type the user specified</p></li>
</ol>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='http://www.rdocumentation.org/packages/stats/topics/aov'>aov</a></code>, <code><a href='http://www.rdocumentation.org/packages/car/topics/leveneTest'>leveneTest</a></code>,
<code><a href='neweta.html'>neweta</a></code>, <code><a href='http://www.rdocumentation.org/packages/stats/topics/replications'>replications</a></code>,
<code><a href='http://www.rdocumentation.org/packages/stats/topics/shapiro.test'>shapiro.test</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>Plot2WayANOVA</span>(<span class='no'>mpg</span>~<span class='no'>am</span>*<span class='no'>cyl</span>, <span class='no'>mtcars</span>, <span class='kw'>plottype</span> <span class='kw'>=</span> <span class='st'>"line"</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Converting am to a factor --- check your results</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Converting cyl to a factor --- check your results</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>You have an unbalanced design. Using Type II sum of squares, eta squared may not sum to 1.0 </span></div><div class='output co'>#&gt; # A tibble: 4 x 8
#&gt;   Source       Df `Sum Sq` `Mean Sq` `F value`       p sigstars `eta sq`
#&gt;   &lt;fct&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;
#&gt; 1 am            1     36.8     36.8       4.00  0.0560 .          0.0330
#&gt; 2 cyl           2    456.     228.       24.8   0.     ***        0.405 
#&gt; 3 am:cyl        2     25.4     12.7       1.40  0.269  ""         0.0230
#&gt; 4 Residuals    26    239.       9.19     NA    NA      &lt;NA&gt;       0.212 </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Table of group means</span></div><div class='output co'>#&gt; # A tibble: 6 x 9
#&gt; # Groups:   am [2]
#&gt;   am    cyl   TheMean TheSD TheSEM CIMuliplier LowerBound UpperBound     N
#&gt;   &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
#&gt; 1 0     4        22.9 1.45   0.839        4.30       19.3       26.5     3
#&gt; 2 0     6        19.1 1.63   0.816        3.18       16.5       21.7     4
#&gt; 3 0     8        15.0 2.77   0.801        2.20       13.3       16.8    12
#&gt; 4 1     4        28.1 4.48   1.59         2.36       24.3       31.8     8
#&gt; 5 1     6        20.6 0.751  0.433        4.30       18.7       22.4     3
#&gt; 6 1     8        15.4 0.566  0.400       12.7        10.3       20.5     2</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Testing Homogeneity of Variance with Brown-Forsythe </span></div><div class='output co'>#&gt; <span class='message'>   *** Possible violation of the assumption ***</span></div><div class='output co'>#&gt; Levene's Test for Homogeneity of Variance (center = median)
#&gt;       Df F value  Pr(&gt;F)  
#&gt; group  5   2.736 0.04086 *
#&gt;       26                  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Testing Normality Assumption with Shapiro-Wilk </span></div><div class='output co'>#&gt; 
#&gt; 	Shapiro-Wilk normality test
#&gt; 
#&gt; data:  MyAOV_residuals
#&gt; W = 0.96277, p-value = 0.3263
#&gt; </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Interaction graph plotted...</span></div><div class='img'><img src='Plot2WayANOVA-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>Plot2WayANOVA</span>(<span class='no'>mpg</span>~<span class='no'>am</span>*<span class='no'>vs</span>, <span class='no'>mtcars</span>, <span class='kw'>confidence</span> <span class='kw'>=</span> <span class='fl'>.99</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Converting am to a factor --- check your results</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Converting vs to a factor --- check your results</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>You have an unbalanced design. Using Type II sum of squares, eta squared may not sum to 1.0 </span></div><div class='output co'>#&gt; # A tibble: 4 x 8
#&gt;   Source       Df `Sum Sq` `Mean Sq` `F value`      p sigstars `eta sq`
#&gt;   &lt;fct&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;
#&gt; 1 am            1    276.      276.      22.9   0.    ***        0.245 
#&gt; 2 vs            1    367.      367.      30.5   0.    ***        0.326 
#&gt; 3 am:vs         1     16.0      16.0      1.30  0.259 ""         0.0140
#&gt; 4 Residuals    28    337.       12.1     NA    NA     &lt;NA&gt;       0.300 </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Table of group means</span></div><div class='output co'>#&gt; # A tibble: 4 x 9
#&gt; # Groups:   am [2]
#&gt;   am    vs    TheMean TheSD TheSEM CIMuliplier LowerBound UpperBound     N
#&gt;   &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
#&gt; 1 0     0        15.0  2.77  0.801        3.11       12.6       17.5    12
#&gt; 2 0     1        20.7  2.47  0.934        3.71       17.3       24.2     7
#&gt; 3 1     0        19.8  4.01  1.64         4.03       13.2       26.3     6
#&gt; 4 1     1        28.4  4.76  1.80         3.71       21.7       35.0     7</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Testing Homogeneity of Variance with Brown-Forsythe </span></div><div class='output co'>#&gt; Levene's Test for Homogeneity of Variance (center = median)
#&gt;       Df F value Pr(&gt;F)
#&gt; group  3  0.8809 0.4629
#&gt;       28               </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Testing Normality Assumption with Shapiro-Wilk </span></div><div class='output co'>#&gt; 
#&gt; 	Shapiro-Wilk normality test
#&gt; 
#&gt; data:  MyAOV_residuals
#&gt; W = 0.97845, p-value = 0.7535
#&gt; </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Interaction graph plotted...</span></div><div class='img'><img src='Plot2WayANOVA-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Chuck Powell

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Chuck Powell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

